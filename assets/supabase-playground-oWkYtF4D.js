import{d as k,e as S,r as m,f as C,l as V,o as n,c as a,u,g as t,t as c,a as A,m as U,h as p,F as M,p as B,i as F,w as _,v}from"./index-HEIN1-Z_.js";const L={class:"flex flex-col gap-3"},N=t("h2",{class:"text-xl font-bold"},"Supabase Playground",-1),D={key:0,class:"flex items-center gap-2"},I={key:1,class:"flex items-center gap-2"},q=t("div",null,"User not logged",-1),E=t("span",null,"login",-1),G=t("th",{class:"border p-4"},"id",-1),P=t("th",{class:"border p-4"},"reference",-1),R=t("th",{class:"border p-4"},"title",-1),T=t("th",{class:"border p-4"},"artist",-1),$=t("th",{class:"border p-4"},"words",-1),j={key:0,class:"border p-4"},z={class:"border p-4"},H={class:"border p-4"},J={class:"border p-4"},K={class:"border p-4"},O={class:"border p-4"},Q={key:0,class:"border p-4"},W=["onClick"],X=t("button",{type:"submit",class:"btn"},"Add",-1),Y={key:3,class:"relative rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700",role:"alert"},se=k({__name:"supabase-playground",setup(Z){const r=S(),f=m([]),i=m(""),o=m({reference:"",title:"",artist:"",words:""});C(async()=>{b()});async function b(){var d;i.value="";try{const{data:e}=await((d=r.supabaseClient)==null?void 0:d.from("musics").select());f.value=e??[]}catch(e){console.error(e),i.value=e}}async function w(d){var e;i.value="";try{const l=await((e=r.supabaseClient)==null?void 0:e.from("musics").delete().eq("id",d.id));if(l!=null&&l.error)throw l==null?void 0:l.error;b()}catch(l){console.error(l),i.value=l}}async function x(){var d;if(o.value.reference&&o.value.title&&o.value.artist&&o.value.words){i.value="";try{const e=await((d=r.supabaseClient)==null?void 0:d.from("musics").insert({...o.value,words:o.value.words.split(", ")}));if(e!=null&&e.error)throw e==null?void 0:e.error;b(),o.value={reference:"",title:"",artist:"",words:""}}catch(e){console.error(e),i.value=e}}}return(d,e)=>{var h,y;const l=V("router-link");return n(),a("div",L,[N,u(r).userSession?(n(),a("div",D,[t("div",null,"Logged as : "+c(u(r).userSession.user.email)+" "+c(u(r).userSession.isAdmin?"[Administrator]":""),1),t("button",{class:"btn",type:"button",onClick:e[0]||(e[0]=(...s)=>u(r).logout&&u(r).logout(...s))}," Logout ")])):(n(),a("div",I,[q,A(l,{"aria-label":"back",class:"btn",to:{name:"login"},type:"button"},{default:U(()=>[E]),_:1})])),t("table",null,[t("thead",null,[t("tr",null,[G,P,R,T,$,(h=u(r).userSession)!=null&&h.isAdmin?(n(),a("th",j)):p("",!0)])]),t("tbody",null,[(n(!0),a(M,null,B(f.value,s=>{var g;return n(),a("tr",null,[t("td",z,c(s.id),1),t("td",H,c(s.reference),1),t("td",J,c(s.title),1),t("td",K,c(s.artist),1),t("td",O,c(s.words),1),(g=u(r).userSession)!=null&&g.isAdmin?(n(),a("td",Q,[t("button",{class:"btn",onClick:ee=>w(s)},"Remove",8,W)])):p("",!0)])}),256))])]),(y=u(r).userSession)!=null&&y.isAdmin?(n(),a("form",{key:2,onSubmit:F(x,["prevent"]),class:"flex gap-2"},[_(t("input",{type:"text",placeholder:"reference","onUpdate:modelValue":e[1]||(e[1]=s=>o.value.reference=s)},null,512),[[v,o.value.reference]]),_(t("input",{type:"text",placeholder:"title","onUpdate:modelValue":e[2]||(e[2]=s=>o.value.title=s)},null,512),[[v,o.value.title]]),_(t("input",{type:"text",placeholder:"artist","onUpdate:modelValue":e[3]||(e[3]=s=>o.value.artist=s)},null,512),[[v,o.value.artist]]),_(t("input",{type:"text",placeholder:"words, words","onUpdate:modelValue":e[4]||(e[4]=s=>o.value.words=s)},null,512),[[v,o.value.words]]),X],32)):p("",!0),i.value?(n(),a("div",Y,c(i.value),1)):p("",!0)])}}});export{se as default};
